<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport"
        content="width=device-width, initial-scale=1.0, minimum-scale=1.0, maximum-scale=1.0,user-scalable=no" />
    <meta http-equiv="X-UA-Compatible" content="ie=edge">
    <meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=8">
    <meta http-equiv="Expires" content="0">
    <meta http-equiv="Pragma" content="no-cache">
    <meta http-equiv="Cache-control" content="no-cache">
    <meta http-equiv="Cache" content="no-cache">
    <title>Document</title>
    <link rel="stylesheet" href="./../css/base.css">
    <link type="text/css" rel="stylesheet" href="./../css/iosSelect.css">
    <link rel="stylesheet" href="./../css/style.css">
</head>

<body id="sign" class="sign">
    <div class="main">
        <form>
            <h2>个人信息</h2>
            <div class="formItem">
                <span>真实姓名</span>
                <input name="name" type="text" placeholder="请填写姓名">
            </div>
            <div class="formItem">
                <span>身份证号</span>
                <input name="idNO" type="text" placeholder="请身份证号码">
            </div>
            <h2 class="mt10">请选择号码</h2>
            <div class="formItem">
                <span>号码归属</span>
                <p id="numSite">
                    <input disabled name="numSite" type="text" placeholder="请选择号码归属地">
                </p>
                <img src="./../img/turnRight.png" alt="">
            </div>
            <div class="formItem">
                <span>选择号码</span>
                <p id="tel">
                    <input disabled name="tel" type="text" placeholder="请选择号码">
                </p>
                <img src="./../img/turnRight.png" alt="">
            </div>
            <h2 class="mt10">请填写配送地址</h2>
            <div class="formItem">
                <span>联系电话</span>
                <input name="contack" type="text" placeholder="请填写联系号码">
            </div>
            <div class="formItem">
                <span>所在地区</span>
                <p id="site">
                    <input disabled name="site" type="text" placeholder="请选择所在地区">
                </p>
                <img src="./../img/turnRight.png" alt="">
            </div>
            <div class="formItem">
                <input name="address" style="width:300px;" type="text" placeholder="请填写街道/镇+村/小区/写字楼+门牌号">
            </div>
            <div class="deal">
                <label for="deal"></label>
                <input name="deal" id="deal" type="checkbox">
                已阅读并同意<span class="intoDeal">《入网协议》</span>
            </div>
        </form>
        <div class="btn submit offBtn">立即提交</div>
        <footer>中国移动通信有限公司</footer>
    </div>
    <div class="popup">
        <div class="ink"></div>
        <!-- 选择号码 -->
        <div class="vessel clearfix chooseTel">
            <h3 class="title">请选择号码</h3>
            <div class="search">
                <input type="text">
                <img src="./../img/ic_fcard_find@2x.png" alt="">
            </div>
            <div class="numList clearfix">
                <p class="fl">1123123<span>1234</span></p>
                <p class="fl">11231231234</p>
                <p class="fl">11231231234</p>
                <p class="fl">11231231234</p>
                <p class="fl">11231231234</p>
                <p class="fl">1123123<span>1234</span></p>
                <p class="fl">11231231234</p>
                <p class="fl">11231231234</p>
                <p class="fl">11231231234</p>
                <p class="fl">88888888888</p>
            </div>
            <!-- 没有数据的时候 -->
            <div class="emtryNum">
                <img src="./../img/image_default_search@2x.png" alt="">
                <p>没有找到相关号码</p>
                <div class="btn searchBtn">查看所有号码</div>
            </div>
            <div class="change">
                <img src="./../img/ic_fcard_refresh@2x.png" alt="">
                换一批
            </div>
            <img class="close closeBtn" src="./../img/img_fcard_pop_x@2x.png" alt="">
        </div>
        <!-- 入网协议 -->
        <div class="vessel clearfix dealDocs">
            <h3 class="title">入网协议</h3>
            <div class="docs">
                1.入文本，输入文本输入文本输入文本输入文本输入文本，输入文本输入文本输入文本输入文本输入文本，输入文本输入文本输入文本输入文本输入文本。
                2.输入文本输入文本输入文本输入文本输入文本，输入文本输入文本输入文本输入文本输入文本，输入文本输入文本输入文本输。
                3.入文本输入文本，输入文本输入文本输入文本输入文本输入文本，输入文本输入文本输入文本输入文本输入文本，输入文本输入文本输入文本输入文本输入文本，输入文本输入文本输入文本输入文本输入文本，输入文本输入文本输入文本输入文本输入文本，输入文本输入文本输入文本输。
                3.入文本输入文本，输入文本输入文本输入文本输入文本输入文本，输入文本输入文本输入文本输入文本输入文本，输入文本输入文本输入文本输入文本输入文本，输入文本输入文本输入文本输入文本输入文本，输入文本输入文本输入文本输入文本输入文本，输入文本输入文本输入文本输。
                3.入文本输入文本，输入文本输入文本输入文本输入文本输入文本，输入文本输入文本输入文本输入文本输入文本，输入文本输入文本输入文本输入文本输入文本，输入文本输入文本输入文本输入文本输入文本，输入文本输入文本输入文本输入文本输入文本，输入文本输入文本输入文本输。
                1.入文本，输入文本输入文本输入文本输入文本输入文本，输入文本输入文本输入文本输入文本输入文本，输入文本输入文本输入输入文本输入文本输入
            </div>
            <img class="close closeBtn" src="./../img/img_fcard_pop_x@2x.png" alt="">
        </div>
        <!-- 二次确认 -->
        <div class="vessel clearfix twice">
            <p class="info">返回上一步，即将失去所选号码，是否继续？</p>
            <div class="twoBtn">
                <span class="closeBtn">取消</span>
                <span>继续</span>
            </div>
        </div>
    </div>
</body>

</html>
<script src="./../js/rem.js"></script>
<script src="./../js/jq.js"></script>
<script src="./../js/select.js"></script>
<script src="./../js/data.js"></script>
<script>
    $(function () {
        // 选择号码
        $("#tel").click(function () {
            $('.popup').show()
            $('.chooseTel').show()
        })

        // 选择号码归属
        /**
         * @iosProvinces 省份数据
         * @iosCitys 城市数据
         */
        numSiteFn(iosProvinces, iosCitys)

        // 选中号码
        $('.numList').on('click', 'p', function () {
            $('#tel input').val(this.innerText)
            console.log($('#tel input').val())
            closePopup()
        })

        // 选择所在区域
        /**
         * @iosProvinces 省份数据
         * @iosCitys 城市数据
         * @iosCountys 县区数据
         */
        siteFn(iosProvinces, iosCitys, iosCountys)

        // 点击立即提交
        $('.submit').click(function () {
            var param = getInputData()
            if (param && param.finish) {
                window.location.href = './result.html'
            }
            window.location.href = './result.html'
        })
        // 控制按钮是否变色
        $('input').blur(function () {
            var param = getInputData()
            if (param && param.finish) {
                $('.submit').removeClass('offBtn')
            } else {
                $('.submit').addClass('offBtn')
            }
        })
        // 同意协议
        $('#deal').click(function (a) {
            var param = getInputData()
            if ($("#deal").is(':checked')) {
                $(".deal label").css('background', "url('./../img/img_fcard_checklist_on@2x.png')")
                $(".deal label").css('background-size', "100%")
                if (param.finish && param.deal) {
                    $('.submit').removeClass('offBtn')
                }
            } else {
                $(".deal label").css('background', "url('./../img/img_fcard_checklist_off@2x.png')")
                $(".deal label").css('background-size', "100%")
                $('.submit').addClass('offBtn')
            }
        })

        // 打开协议
        $('.intoDeal').click(function () {
            $('.popup').show()
            $('.dealDocs').show()
        })
        // 关闭弹窗
        $('.closeBtn').click(function () {
            closePopup()
        })
        // 关闭弹窗的方法
        function closePopup() {
            $('.popup').hide()
            $('.dealDocs').hide()
            $('.chooseTel').hide()
            $('.twice').hide()
        }
        /**
         * 获取表单数据的方法
         * 返回一个对象，属性值为input属性name的地址 ，值为输入的数据
         * 其中 有一个finish , true 表示值填全了 ， false 表示没填完整
         */
        function getInputData() {
            var dom = document.querySelectorAll('form input')
            var data = {
                finish: true
            }
            dom.forEach(element => {
                var name = element.attributes.name.nodeValue
                var val = element.value
                if (!val) data.finish = false
                if (name) {
                    data[name] = val
                }
                if (element.attributes.type.nodeValue === 'checkbox') {
                    if (element.checked) {
                        data[name] = true
                    } else {
                        data[name] = false
                        data.finish = false
                    }
                }
            })
            return data
        }
        //号码归属
        function numSiteFn(iosProvinces, iosCitys) {
            var selectContactDom = $('#numSite');
            var showContactDom = $('#numSite input');
            selectContactDom.bind('click', function () {
                var sccode = showContactDom.attr('data-city-code');
                var scname = showContactDom.attr('data-city-name');
                var oneLevelId = showContactDom.attr('data-province-code');
                var twoLevelId = showContactDom.attr('data-city-code');
                // 多少个选择项
                var iosSelect = new IosSelect(2, [iosProvinces, iosCitys], {
                    title: '归属地选择',
                    itemHeight: .96,
                    headerHeight: 0.86,
                    itemShowCount: 5,
                    cssUnit: 'rem',
                    relation: [1, 1],
                    oneLevelId: oneLevelId,
                    twoLevelId: twoLevelId,
                    callback: function (selectOneObj, selectTwoObj, selectThreeObj) {
                        showContactDom.attr('data-province-code', selectOneObj.id);
                        showContactDom.attr('data-city-code', selectTwoObj.id);
                        showContactDom.val(selectOneObj.value + ' ' + selectTwoObj.value);
                    }
                });
            });
        }
        //所在地区
        function siteFn(iosProvinces, iosCitys, iosCountys) {
            var selectContactDom = $('#site');
            var showContactDom = $('#site input');
            selectContactDom.bind('click', function () {
                var sccode = showContactDom.attr('data-city-code');
                var scname = showContactDom.attr('data-city-name');
                var oneLevelId = showContactDom.attr('data-province-code');
                var twoLevelId = showContactDom.attr('data-city-code');
                // 多少个选择项
                var iosSelect = new IosSelect(3, [iosProvinces, iosCitys, iosCountys], {
                    title: '配送地址选择',
                    itemHeight: .96,
                    headerHeight: 0.86,
                    itemShowCount: 5,
                    cssUnit: 'rem',
                    relation: [1, 1],
                    oneLevelId: oneLevelId,
                    twoLevelId: twoLevelId,
                    callback: function (selectOneObj, selectTwoObj, selectThreeObj) {
                        showContactDom.attr('data-province-code', selectOneObj.id);
                        showContactDom.attr('data-city-code', selectTwoObj.id);
                        showContactDom.attr('data-district-code', selectThreeObj.id);
                        showContactDom.val(selectOneObj.value + ' ' + selectTwoObj.value +
                            ' ' + selectThreeObj.value);
                    }
                });
            });
        }
        // 搜索的时候图标切换
        $('.search input').keyup(function(){
            if($('.search input').val()){
                $('.search img').attr('src','./../img/searchClose.png')
            }else{
                $('.search img').attr('src','./../img/ic_fcard_find@2x.png')
            }
        })
        // 搜索的时候清除输入框数据
        $('.search').on('click','img',function(){
            $('.search input').val('')
            $('.search img').attr('src','./../img/ic_fcard_find@2x.png')
        })
    })
</script>